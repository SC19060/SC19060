<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Minhui Zhu" />


<title>Introduction to SC19060</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19060</h1>
<h4 class="author">Minhui Zhu</h4>
<h4 class="date">r Sys.Date()</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>_SC19060__ is a simple R package has twu functions.The first function is used to make up missing values with median. The second funtion is used to generate the Cauchy distribution by Metropolis sampler.</p>
<p>In the data that we collect, there will be missing values. How to deal with these missing values is a common problem. We can fill in the missing value according to the similarity between samples. The following code shows that we can fill in the missing value by median, because the median is a good indicator of data centre trends.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">MakeupMissingValue&lt;-<span class="cf">function</span>(data)</a>
<a class="sourceLine" id="cb1-2" title="2">{</a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(<span class="kw">ncol</span>(data)))</a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="cf">if</span>(<span class="kw">any</span>(a&lt;-<span class="kw">is.na</span>(data[,i])))</a>
<a class="sourceLine" id="cb1-5" title="5">    {</a>
<a class="sourceLine" id="cb1-6" title="6">      data[a,i]&lt;-<span class="kw">median</span>(data[,i],<span class="dt">na.rm =</span> T)</a>
<a class="sourceLine" id="cb1-7" title="7">    }</a>
<a class="sourceLine" id="cb1-8" title="8">  data</a>
<a class="sourceLine" id="cb1-9" title="9">}</a></code></pre></div>
<p>The basic idea of Metropolis sampler is that we can if we want to take a sample of a more complex distribution, we can sample from a known simpler distribution first, and then accept this sample as an approximate sample of the target distribution with a certain probability. The following code shows that how to generate Cauchy distribution by using Metropolis sampler.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">Metro.Cauchy &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb2-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb2-3" title="3">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb2-4" title="4">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb2-5" title="5">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb2-7" title="7">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>y<span class="op">^</span><span class="dv">2</span>))) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>(pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x[i<span class="dv">-1</span>]<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb2-9" title="9">      x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb2-10" title="10">        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb2-11" title="11">        k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-12" title="12">      } </a>
<a class="sourceLine" id="cb2-13" title="13">  }</a>
<a class="sourceLine" id="cb2-14" title="14">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb2-15" title="15">}</a></code></pre></div>
</div>
<div id="section" class="section level2">
<h2>2019/09/20</h2>
<p>Example 1</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">ctl&lt;-<span class="kw">c</span>(<span class="fl">7.82</span>,<span class="fl">8.41</span>,<span class="fl">7.39</span>,<span class="fl">9.02</span>,<span class="fl">7.62</span>,<span class="fl">8.27</span>,<span class="fl">7.93</span>,<span class="fl">7.26</span>,<span class="fl">8.53</span>,<span class="fl">7.74</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">trt&lt;-<span class="kw">c</span>(<span class="fl">6.54</span>,<span class="fl">5.73</span>,<span class="fl">6.38</span>,<span class="fl">6.36</span>,<span class="fl">6.93</span>,<span class="fl">7.05</span>,<span class="fl">5.53</span>,<span class="fl">6.75</span>,<span class="fl">6.87</span>,<span class="fl">5.76</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">group&lt;-<span class="kw">gl</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Ctl&quot;</span>,<span class="st">&quot;Trt&quot;</span>))</a>
<a class="sourceLine" id="cb3-4" title="4">weight&lt;-<span class="kw">c</span>(ctl,trt)</a>
<a class="sourceLine" id="cb3-5" title="5">lm.D9&lt;-<span class="kw">lm</span>(weight<span class="op">~</span>group)</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="kw">summary</span>(lm.D9)<span class="op">$</span>coef</a></code></pre></div>
<pre><code>##             Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)    7.999  0.1734309 46.122115 3.837721e-20
## groupTrt      -1.609  0.2452683 -6.560162 3.653059e-06</code></pre>
<p>Example 2</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(CO2))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Plant</th>
<th align="left">Type</th>
<th align="left">Treatment</th>
<th align="right">conc</th>
<th align="right">uptake</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">95</td>
<td align="right">16.0</td>
</tr>
<tr class="even">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">175</td>
<td align="right">30.4</td>
</tr>
<tr class="odd">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">250</td>
<td align="right">34.8</td>
</tr>
<tr class="even">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">350</td>
<td align="right">37.2</td>
</tr>
<tr class="odd">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">500</td>
<td align="right">35.3</td>
</tr>
<tr class="even">
<td align="left">Qn1</td>
<td align="left">Quebec</td>
<td align="left">nonchilled</td>
<td align="right">675</td>
<td align="right">39.2</td>
</tr>
</tbody>
</table>
<p>Example 3</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">x&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb6-2" title="2">y&lt;-<span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">sunflowerplot</span>(x,y)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Example 4</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co">#par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#plot(CO2)</span></a></code></pre></div>
</div>
<div id="section-1" class="section level2">
<h2>2019/09/29</h2>
<p>##Question The Rayleigh density [156, Ch. 18] is f(x)= e<sup>{-x</sup>{2} /(2 ^{2})} ,x 0, &gt;0 Develop an algorithm to generate random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ (check the histogram).</p>
<p>##Answer</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">n&lt;-<span class="fl">1e5</span></a>
<a class="sourceLine" id="cb8-2" title="2">m&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb8-3" title="3">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb8-4" title="4">sigma&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb8-5" title="5">x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb8-7" title="7">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,.<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">lines</span>(y,y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">n&lt;-<span class="fl">1e5</span></a>
<a class="sourceLine" id="cb9-2" title="2">m&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb9-3" title="3">u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb9-4" title="4">sigma&lt;-<span class="fl">0.5</span></a>
<a class="sourceLine" id="cb9-5" title="5">x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb9-6" title="6"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))</a>
<a class="sourceLine" id="cb9-7" title="7">y&lt;-<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,.<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-8" title="8"><span class="kw">lines</span>(y,y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>##Question Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0, 1) and N(3, 1) distributions with mixing probabilities p1 and p2 = 1 − p1. Graph the histogram of the sample with density superimposed, for p1 = 0.75. Repeat with different values for p1 and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
<p>##Answer</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb10-2" title="2">X1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-3" title="3">X2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-4" title="4">Z1&lt;-<span class="fl">0.75</span><span class="op">*</span>X1<span class="fl">+0.25</span><span class="op">*</span>X2</a>
<a class="sourceLine" id="cb10-5" title="5">Z2&lt;-<span class="fl">0.5</span><span class="op">*</span>X1<span class="fl">+0.5</span><span class="op">*</span>X2</a>
<a class="sourceLine" id="cb10-6" title="6">Z3&lt;-<span class="fl">0.1</span><span class="op">*</span>X1<span class="fl">+0.9</span><span class="op">*</span>X2</a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#par(mfrow=c(1,3))</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="kw">hist</span>(Z1);<span class="kw">hist</span>(Z2);<span class="kw">hist</span>(Z3)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --> when p1=p2=0.5,empirical distribution of the mixture appears is bimodal.</p>
<p>##Question Write a function to generate a random sample from a Wd(Σ, n) (Wishart)distribution for n&gt;d + 1 ≥ 1, based on Bartlett’s decomposition.</p>
<p>##Answer</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">d&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb11-2" title="2">n&lt;-<span class="dv">6</span></a>
<a class="sourceLine" id="cb11-3" title="3">x&lt;-<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">C&lt;-<span class="kw">matrix</span>(x,<span class="dt">nrow =</span> <span class="dv">4</span>,<span class="dt">ncol =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">L&lt;-<span class="kw">t</span>(<span class="kw">chol</span>(C))</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co">#get a lower triangular</span></a>
<a class="sourceLine" id="cb11-7" title="7">sigma&lt;-L<span class="op">%*%</span><span class="kw">t</span>(L)</a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co">#since L is a lower triangular, so sigma can do the Choleski factorization</span></a>
<a class="sourceLine" id="cb11-9" title="9">c1&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb11-10" title="10">c2&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb11-11" title="11">c3&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dv">4</span>))</a>
<a class="sourceLine" id="cb11-12" title="12">c4&lt;-<span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb11-13" title="13">n21&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-14" title="14">n31&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-15" title="15">n32&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-16" title="16">n41&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-17" title="17">n42&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-18" title="18">n43&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-19" title="19">h&lt;-<span class="kw">c</span>(c1,n21,n31,n41,<span class="dv">0</span>,c2,n32,n42,<span class="dv">0</span>,<span class="dv">0</span>,c3,n43,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,c4)</a>
<a class="sourceLine" id="cb11-20" title="20">T&lt;-<span class="kw">matrix</span>(h,<span class="dt">nrow =</span> <span class="dv">4</span>,<span class="dt">ncol =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co">#T is a lower triangular 4*4 random matrix</span></a>
<a class="sourceLine" id="cb11-22" title="22">A&lt;-T<span class="op">%*%</span><span class="kw">t</span>(T)</a>
<a class="sourceLine" id="cb11-23" title="23">X&lt;-L<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(L)</a>
<a class="sourceLine" id="cb11-24" title="24">X</a></code></pre></div>
<pre><code>##            [,1]      [,2]      [,3]       [,4]
## [1,]  5.2507551 -4.516737 -5.448067  0.6376369
## [2,] -4.5167373 11.646261  9.721826  4.0798260
## [3,] -5.4480666  9.721826 12.765862  2.9097402
## [4,]  0.6376369  4.079826  2.909740 24.1477179</code></pre>
</div>
<div id="section-2" class="section level2">
<h2>2019/10/11</h2>
</div>
<div id="section-3" class="section level1">
<h1>5.1</h1>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi / 3} \sin t d t\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer" class="section level1">
<h1>Answer</h1>
<p>First, consider that 0 and <span class="math display">\[\pi / 3\]</span> are finite, we can set a equal to 0, b equal to <span class="math inline">\(\pi / 3\)</span>, <span class="math inline">\(h(t)\)</span> equal to <span class="math inline">\(sinT\)</span>, <span class="math inline">\(g(t)\)</span> equal to <span class="math display">\[\frac{\pi}{3}\sin t\]</span>, then <span class="math display">\[\int_{a}^{b} h(t) d t=\int_{a}^{b} g(t) \frac{1}{b-a} d x=E[g(t)]\]</span> where <span class="math display">\[T \sim U(a, b), g(t)=(b-a) h(t)\]</span>. Second, use a frequency to approximate the expectation (Strong Law of Large Number): <span class="math display">\[\frac{1}{m} \sum_{i=1}^{m} g\left(X_{i}\right)\]</span> wherer <span class="math inline">\(X_1\)</span>,…,<span class="math inline">\(X_m\)</span> are iid copies of X and m is a sufficiently large integer.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">m&lt;-<span class="fl">1e4</span>;t&lt;-<span class="kw">runif</span>(m,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-2" title="2">theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(t))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.5026819 0.5000000</code></pre>
<p>From the result, Monte Carlo method is relatively accurate.</p>
</div>
<div id="section-4" class="section level1">
<h1>5.10</h1>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-1" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb15-2" title="2">u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span></a>
<a class="sourceLine" id="cb15-4" title="4">v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb15-5" title="5">u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</a>
<a class="sourceLine" id="cb15-6" title="6">cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb15-7" title="7">g &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-8" title="8">cdf&lt;-<span class="kw">mean</span>(g)</a>
<a class="sourceLine" id="cb15-9" title="9">cdf</a>
<a class="sourceLine" id="cb15-10" title="10">}</a>
<a class="sourceLine" id="cb15-11" title="11"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb15-12" title="12">MC1 &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(<span class="dt">anti =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-13" title="13"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb15-14" title="14">MC2 &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(<span class="dt">anti =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-15" title="15"><span class="kw">print</span>(<span class="kw">c</span>(MC1,MC2))</a></code></pre></div>
<pre><code>## [1] 0.5263106 0.5246837</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb17-2" title="2">MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb17-4" title="4">MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(<span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb17-5" title="5">MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(<span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb17-6" title="6">}</a>
<a class="sourceLine" id="cb17-7" title="7"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">sd</span>(MC1),<span class="kw">sd</span>(MC2),(<span class="kw">var</span>(MC1) <span class="op">-</span><span class="st"> </span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1)))</a></code></pre></div>
<pre><code>## [1] 0.007710907 0.001407317 0.966690144</code></pre>
<p>The antithetic variable approach achieved approximately 96.7% reduction in variance.</p>
</div>
<div id="section-5" class="section level1">
<h1>5.15</h1>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10</p>
</div>
<div id="answer-2" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">u&lt;-<span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">2</span>,.<span class="dv">4</span>,.<span class="dv">6</span>,.<span class="dv">8</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">quintile&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))<span class="co">#generate  quintile</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">round</span>(quintile,<span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.00 0.14 0.29 0.48 0.70 1.00</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">M &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb21-2" title="2">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>) }</a>
<a class="sourceLine" id="cb21-6" title="6">u &lt;-<span class="st"> </span><span class="kw">runif</span>(M) <span class="co">#f3, inverse transform method</span></a>
<a class="sourceLine" id="cb21-7" title="7">x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-8" title="8">fg &lt;-<span class="st"> </span><span class="dv">5</span><span class="op">*</span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb21-10" title="10">T2[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M<span class="op">/</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="fl">.14</span>)))</a>
<a class="sourceLine" id="cb21-11" title="11">T2[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M<span class="op">/</span><span class="dv">4</span>, <span class="fl">.14</span>, <span class="fl">.29</span>)))</a>
<a class="sourceLine" id="cb21-12" title="12">T2[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M<span class="op">/</span><span class="dv">4</span>, <span class="fl">.29</span>, <span class="fl">.48</span>)))</a>
<a class="sourceLine" id="cb21-13" title="13">T2[<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M<span class="op">/</span><span class="dv">4</span>, <span class="fl">.48</span>, <span class="dv">70</span>)))</a>
<a class="sourceLine" id="cb21-14" title="14">T2[<span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(<span class="kw">runif</span>(M<span class="op">/</span><span class="dv">4</span>, <span class="fl">.70</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb21-15" title="15">estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</a>
<a class="sourceLine" id="cb21-16" title="16">}</a>
<a class="sourceLine" id="cb21-17" title="17"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean)</a></code></pre></div>
<pre><code>## [1] 0.5092268</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, sd)</a></code></pre></div>
<pre><code>## [1] 0.0002849442</code></pre>
<p>Compare these two methods, the stratified importance sampling method is better.</p>
<div id="section-6" class="section level2">
<h2>2019/10/18</h2>
</div>
</div>
<div id="section-7" class="section level1">
<h1>6.5</h1>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-3" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb25-2" title="2">alpha&lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb25-3" title="3">UCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb25-4" title="4">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb25-6" title="6">})</a>
<a class="sourceLine" id="cb25-7" title="7"><span class="kw">sum</span>(UCL<span class="op">&gt;</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 917</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.917</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">a&lt;-<span class="kw">abs</span>(<span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">2</span>)<span class="op">/</span>.<span class="dv">95-1</span>)</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="co">#calculate the difference between t-interval results and 0.95 </span></a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb30-2" title="2">alpha&lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb30-3" title="3">UCL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb30-4" title="4">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-5" title="5">  (n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">qchisq</span>(alpha,<span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb30-6" title="6">})</a>
<a class="sourceLine" id="cb30-7" title="7"><span class="kw">sum</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 776</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.776</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">b&lt;-<span class="kw">abs</span>(<span class="kw">mean</span>(UCL<span class="op">&gt;</span><span class="dv">4</span>)<span class="op">/</span>.<span class="dv">95-1</span>)</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co"># calculate the difference between the results in example6.4 with 0.95</span></a></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(a,b))</a></code></pre></div>
<pre><code>## [1] 0.03473684 0.18315789</code></pre>
<p>Apparently, the t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
<div id="section-8" class="section level1">
<h1>6.6</h1>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
</div>
<div id="answer-4" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">n&lt;-<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb37-2" title="2">q&lt;-<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>)</a>
<a class="sourceLine" id="cb37-3" title="3">sk&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb37-4" title="4">x&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb37-5" title="5">xbar&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb37-6" title="6">v3&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb37-7" title="7">v2&lt;-<span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb37-8" title="8">v3<span class="op">/</span>(v2<span class="op">^</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)) <span class="co"># the skewness </span></a>
<a class="sourceLine" id="cb37-9" title="9">})</a>
<a class="sourceLine" id="cb37-10" title="10">q1&lt;-<span class="kw">quantile</span>(sk,q)</a>
<a class="sourceLine" id="cb37-11" title="11">q2&lt;-<span class="kw">qnorm</span>(q,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb37-12" title="12"><span class="co"># estimate the 0.025,0.05,0.95,0.975 quantiles of the skewness under normality</span></a>
<a class="sourceLine" id="cb37-13" title="13"><span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(q1,q2),<span class="dv">5</span>))</a></code></pre></div>
<pre><code>##        2.5%       5%     95%   97.5%
## q1 -0.04912 -0.03981 0.04237 0.04874
## q2 -0.04801 -0.04029 0.04029 0.04801</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">q&lt;-<span class="kw">c</span>(.<span class="dv">025</span>,.<span class="dv">05</span>,.<span class="dv">95</span>,.<span class="dv">975</span>)</a>
<a class="sourceLine" id="cb39-2" title="2">sd&lt;-var&lt;-<span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb39-4" title="4">  var[i]&lt;-q[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q[i])<span class="op">/</span>(n<span class="op">*</span><span class="kw">dnorm</span>(q1[i],<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb39-5" title="5">  sd[i]&lt;-<span class="kw">sqrt</span>(var[i])</a>
<a class="sourceLine" id="cb39-6" title="6">}</a>
<a class="sourceLine" id="cb39-7" title="7"><span class="kw">print</span>(sd)</a></code></pre></div>
<pre><code>## [1] 0.0007164870 0.0005014469 0.0005975458 0.0006947495</code></pre>
<div id="section-9" class="section level2">
<h2>2019/11/01</h2>
</div>
</div>
<div id="section-10" class="section level1">
<h1>6.7</h1>
<p>Estimate the power of the skewness test of normality against symmetric<span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span>distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</p>
</div>
<div id="answer-5" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co">#compute the sample skewness statistic</span></a>
<a class="sourceLine" id="cb41-2" title="2">sk&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb41-3" title="3">  xbar&lt;-<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb41-4" title="4">  m3&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb41-5" title="5">  m2&lt;-<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb41-6" title="6">  <span class="kw">return</span>(m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb41-7" title="7">}</a></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">alpha&lt;-.<span class="dv">1</span></a>
<a class="sourceLine" id="cb42-2" title="2">n&lt;-<span class="dv">30</span> <span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb42-3" title="3">m&lt;-<span class="dv">2500</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb42-4" title="4">a&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(.<span class="dv">1</span>,<span class="dv">20</span>,.<span class="dv">1</span>)) <span class="co">#the parameter of beta distribution</span></a>
<a class="sourceLine" id="cb42-5" title="5">N&lt;-<span class="kw">length</span>(a)</a>
<a class="sourceLine" id="cb42-6" title="6">pwr&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb42-7" title="7">cv&lt;-<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb42-8" title="8"><span class="co">#critical value  for the skewness test</span></a>
<a class="sourceLine" id="cb42-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb42-10" title="10">  sktests&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb42-11" title="11">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb42-12" title="12">    x&lt;-<span class="kw">rbeta</span>(n,a[i],a[i])</a>
<a class="sourceLine" id="cb42-13" title="13">    sktests[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb42-14" title="14">  }</a>
<a class="sourceLine" id="cb42-15" title="15">  pwr[i]&lt;-<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb42-16" title="16">}</a>
<a class="sourceLine" id="cb42-17" title="17"><span class="co">#plot power vs a</span></a>
<a class="sourceLine" id="cb42-18" title="18"><span class="kw">plot</span>(a,pwr,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb42-19" title="19">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(a),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb42-20" title="20"><span class="kw">abline</span>(<span class="dt">h=</span>.<span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb42-21" title="21">se&lt;-<span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb42-22" title="22"><span class="kw">lines</span>(a,pwr<span class="op">+</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb42-23" title="23"><span class="kw">lines</span>(a,pwr<span class="op">-</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From we can see that the power of the skewness test of normality against symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> is very low.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">alpha&lt;-.<span class="dv">1</span></a>
<a class="sourceLine" id="cb43-2" title="2">n&lt;-<span class="dv">30</span> <span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb43-3" title="3">m&lt;-<span class="dv">2500</span> <span class="co">#number of replicate</span></a>
<a class="sourceLine" id="cb43-4" title="4">v&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>)) <span class="co">#the parameter of t distribution</span></a>
<a class="sourceLine" id="cb43-5" title="5">N&lt;-<span class="kw">length</span>(v)</a>
<a class="sourceLine" id="cb43-6" title="6">pwr&lt;-<span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb43-7" title="7">cv&lt;-<span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb43-8" title="8"><span class="co">#critical value  for the skewness test</span></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb43-10" title="10">  sktests&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb43-11" title="11">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb43-12" title="12">    x&lt;-<span class="kw">rt</span>(n,v[i])</a>
<a class="sourceLine" id="cb43-13" title="13">    sktests[j]&lt;-<span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x))<span class="op">&gt;=</span>cv)</a>
<a class="sourceLine" id="cb43-14" title="14">  }</a>
<a class="sourceLine" id="cb43-15" title="15">  pwr[i]&lt;-<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb43-16" title="16">}</a>
<a class="sourceLine" id="cb43-17" title="17"><span class="co">#plot power vs v</span></a>
<a class="sourceLine" id="cb43-18" title="18"><span class="kw">plot</span>(v,pwr,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb43-19" title="19">     <span class="dt">xlab =</span> <span class="kw">bquote</span>(v),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb43-20" title="20"><span class="kw">abline</span>(<span class="dt">h=</span>.<span class="dv">1</span>,<span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-21" title="21">se&lt;-<span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb43-22" title="22"><span class="kw">lines</span>(v,pwr<span class="op">+</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-23" title="23"><span class="kw">lines</span>(v,pwr<span class="op">-</span>se,<span class="dt">lty=</span><span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot we can see that the power of the skewness test of normality against t(v) is better than <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span></p>
</div>
<div id="a" class="section level1">
<h1>6.A</h1>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i)<span class="math inline">\(\chi^{2}(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_{0}: \mu=\mu_{0}\)</span> vs <span class="math inline">\(H_{0}: \mu \neq \mu_{0}\)</span>, where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-6" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">n&lt;-<span class="dv">20</span></a>
<a class="sourceLine" id="cb44-2" title="2">alpha&lt;-.<span class="dv">05</span></a>
<a class="sourceLine" id="cb44-3" title="3">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb44-4" title="4">m&lt;-<span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb44-5" title="5">p&lt;-<span class="kw">numeric</span>(m) <span class="co">#storage for p-value</span></a></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb45-2" title="2">  x&lt;-<span class="kw">rchisq</span>(n,<span class="dv">1</span>) <span class="co">#sample population is Chisq(1)</span></a>
<a class="sourceLine" id="cb45-3" title="3">  ttest&lt;-<span class="kw">t.test</span>(x,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb45-4" title="4">  p[j]&lt;-ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb45-5" title="5">}</a>
<a class="sourceLine" id="cb45-6" title="6">p.hat&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb45-7" title="7">se.hat&lt;-<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb45-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(p.hat,se.hat))</a></code></pre></div>
<pre><code>## [1] 0.012200000 0.001097778</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb47-2" title="2">  x&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>) <span class="co">#sample population is Uniform(0,2)</span></a>
<a class="sourceLine" id="cb47-3" title="3">  ttest&lt;-<span class="kw">t.test</span>(x,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb47-4" title="4">  p[j]&lt;-ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb47-5" title="5">}</a>
<a class="sourceLine" id="cb47-6" title="6">p.hat&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb47-7" title="7">se.hat&lt;-<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb47-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(p.hat,se.hat))</a></code></pre></div>
<pre><code>## [1] 0.048100000 0.002139775</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb49-2" title="2">  x&lt;-<span class="kw">rexp</span>(n,<span class="dv">1</span>) <span class="co">#sample population is Exponential(1)</span></a>
<a class="sourceLine" id="cb49-3" title="3">  ttest&lt;-<span class="kw">t.test</span>(x,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">mu=</span>mu0)</a>
<a class="sourceLine" id="cb49-4" title="4">  p[j]&lt;-ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb49-5" title="5">}</a>
<a class="sourceLine" id="cb49-6" title="6">p.hat&lt;-<span class="kw">mean</span>(p<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb49-7" title="7">se.hat&lt;-<span class="kw">sqrt</span>(p.hat<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p.hat)<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb49-8" title="8"><span class="kw">print</span>(<span class="kw">c</span>(p.hat,se.hat))</a></code></pre></div>
<pre><code>## [1] 0.018000000 0.001329511</code></pre>
<p>From the result we can see that the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span> when the sample population is Uniform(0,2), while the empirical Type I error rate of the t-test leads to great deviation if the sample population is Chisq(1) or Exponential(1).</p>
</div>
<div id="discussion" class="section level1">
<h1>Discussion</h1>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level? (1)What is the corresponding hypothesis test problem?</p>
<p>(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>(3)What information is needed to test your hypothesis?</p>
</div>
<div id="answer-7" class="section level1">
<h1>Answer</h1>
<p>(1)At a significance level of 0.05, check if 0.651 is equal to 0.676</p>
<p>(2)we should use paired-t test, because the difference in paired data eliminates the difference between the sample data, the standard deviation used for the test excludes the effects of differences between the sample data, leaving only the differences between the different methods. The standard deviation used for the test in the two-sample t-test also contains data differences, which causes the standard deviation to increase, resulting in a factor that is not significant.</p>
<p>(3)We need more observations.</p>
<div id="section-11" class="section level2">
<h2>2019/11/08</h2>
</div>
</div>
<div id="section-12" class="section level1">
<h1>7.6</h1>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\(\left(x_{i 1}, \ldots, x_{i 5}\right)\)</span> for the <span class="math inline">\(i^{t h}\)</span> student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec}), \hat{\rho}_{34}=\hat{\rho}(\mathrm{alg},\text { ana), } \hat{\rho}_{35}=\hat{\rho}(\text { alg, sta }), \hat{\rho}_{45}=\hat{\rho}(\text { ana, sta }).\)</span></p>
</div>
<div id="answer-8" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb51-2" title="2"><span class="kw">pairs</span>(scor) </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co">#display the scatter plots for each pair of test scores</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">cor</span>(scor) <span class="co">#the sample correlation matrix</span></a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">library</span>(corrplot)</a></code></pre></div>
<pre><code>## corrplot 0.84 loaded</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">corrplot</span>(<span class="kw">cor</span>(scor),<span class="dt">addCoef.col =</span> <span class="st">&#39;yellow&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the scatter plots and the sample correlation matrix we can see that these five test scores have correlation.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">B&lt;-<span class="dv">200</span> </a>
<a class="sourceLine" id="cb57-2" title="2"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb57-3" title="3">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb57-4" title="4"><span class="co">#sample sizes</span></a>
<a class="sourceLine" id="cb57-5" title="5">R&lt;-<span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb57-6" title="6"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb57-7" title="7">  i&lt;-<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dt">size =</span> n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb57-8" title="8">  mec&lt;-scor<span class="op">$</span>mec[i]</a>
<a class="sourceLine" id="cb57-9" title="9">  vec&lt;-scor<span class="op">$</span>vec[i]</a>
<a class="sourceLine" id="cb57-10" title="10">  alg&lt;-scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb57-11" title="11">  ana&lt;-scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb57-12" title="12">  sta&lt;-scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb57-13" title="13">  R[b]&lt;-<span class="kw">cor</span>(mec,vec)</a>
<a class="sourceLine" id="cb57-14" title="14">}</a>
<a class="sourceLine" id="cb57-15" title="15"><span class="kw">print</span>(se.R&lt;-<span class="kw">sd</span>(R))</a></code></pre></div>
<pre><code>## [1] 0.07953738</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">R[b]&lt;-<span class="kw">cor</span>(alg,ana)</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">print</span>(se.R&lt;-<span class="kw">sd</span>(R))</a></code></pre></div>
<pre><code>## [1] 0.07991412</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">R[b]&lt;-<span class="kw">cor</span>(alg,sta)</a>
<a class="sourceLine" id="cb61-2" title="2"><span class="kw">print</span>(se.R&lt;-<span class="kw">sd</span>(R))</a></code></pre></div>
<pre><code>## [1] 0.07908261</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">R[b]&lt;-<span class="kw">cor</span>(ana,sta)</a>
<a class="sourceLine" id="cb63-2" title="2"><span class="kw">print</span>(se.R&lt;-<span class="kw">sd</span>(R))</a></code></pre></div>
<pre><code>## [1] 0.07902883</code></pre>
</div>
<div id="b" class="section level1">
<h1>7.B</h1>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and χ2(5) distributions (positive <span class="math inline">\(\chi^{2}(5)\)</span>skewness).</p>
</div>
<div id="answer-9" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">sk&lt;-<span class="dv">0</span>;n&lt;-<span class="fl">1e1</span>;m&lt;-<span class="fl">1e3</span>;<span class="kw">library</span>(boot);<span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb65-2" title="2">boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb65-3" title="3">  Ubar&lt;-<span class="kw">mean</span>(U[i])</a>
<a class="sourceLine" id="cb65-4" title="4">  m3&lt;-<span class="kw">mean</span>((U[i]<span class="op">-</span>Ubar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb65-5" title="5">  m2&lt;-<span class="kw">mean</span>((U[i]<span class="op">-</span>Ubar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-6" title="6">  R&lt;-m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb65-7" title="7">  <span class="kw">return</span>(R)</a>
<a class="sourceLine" id="cb65-8" title="8">}</a>
<a class="sourceLine" id="cb65-9" title="9">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb65-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb65-11" title="11">  U&lt;-<span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb65-12" title="12">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U,<span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb65-13" title="13">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb65-14" title="14">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb65-15" title="15">  ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb65-16" title="16">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb65-17" title="17">}</a>
<a class="sourceLine" id="cb65-18" title="18"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk),</a>
<a class="sourceLine" id="cb65-19" title="19"><span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk),</a>
<a class="sourceLine" id="cb65-20" title="20"><span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk))</a></code></pre></div>
<pre><code>## norm = 0.907 basic = 0.892 perc = 0.999</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1">sk&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>);n&lt;-<span class="fl">1e1</span>;m&lt;-<span class="fl">1e3</span>;<span class="kw">library</span>(boot);<span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb67-2" title="2">boot.sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb67-3" title="3">  Ubar&lt;-<span class="kw">mean</span>(U[i])</a>
<a class="sourceLine" id="cb67-4" title="4">  m3&lt;-<span class="kw">mean</span>((U[i]<span class="op">-</span>Ubar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb67-5" title="5">  m2&lt;-<span class="kw">mean</span>((U[i]<span class="op">-</span>Ubar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb67-6" title="6">  R&lt;-m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb67-7" title="7">  <span class="kw">return</span>(R)</a>
<a class="sourceLine" id="cb67-8" title="8">}</a>
<a class="sourceLine" id="cb67-9" title="9">ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb67-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb67-11" title="11">  U&lt;-<span class="kw">rchisq</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb67-12" title="12">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> U,<span class="dt">statistic=</span>boot.sk, <span class="dt">R =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb67-13" title="13">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb67-14" title="14">  ci.norm[i,]&lt;-ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb67-15" title="15">  ci.basic[i,]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb67-16" title="16">  ci.perc[i,]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</a>
<a class="sourceLine" id="cb67-17" title="17">}</a>
<a class="sourceLine" id="cb67-18" title="18"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk),</a>
<a class="sourceLine" id="cb67-19" title="19"><span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk),</a>
<a class="sourceLine" id="cb67-20" title="20"><span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>sk <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>sk))</a></code></pre></div>
<pre><code>## norm = 0.753 basic = 0.72 perc = 0.739</code></pre>
<div id="section-13" class="section level2">
<h2>2019/11/15</h2>
</div>
</div>
<div id="section-14" class="section level1">
<h1>7.8</h1>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-10" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb69-2" title="2">data&lt;-scor</a>
<a class="sourceLine" id="cb69-3" title="3">n&lt;-<span class="kw">nrow</span>(data)</a>
<a class="sourceLine" id="cb69-4" title="4">sigma&lt;-<span class="kw">cov</span>(data) <span class="co">#compute the covariance matrix</span></a>
<a class="sourceLine" id="cb69-5" title="5">lamda&lt;-<span class="kw">eigen</span>(sigma)<span class="op">$</span>values <span class="co">#compute the eigenvalues</span></a>
<a class="sourceLine" id="cb69-6" title="6">theta&lt;-<span class="kw">max</span>(lamda)<span class="op">/</span><span class="kw">sum</span>(lamda)</a>
<a class="sourceLine" id="cb69-7" title="7"></a>
<a class="sourceLine" id="cb69-8" title="8"><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></a>
<a class="sourceLine" id="cb69-9" title="9">theta.jack&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb69-10" title="10"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb69-11" title="11">    sigma.jack&lt;-<span class="kw">cov</span>(data[<span class="op">-</span>i])</a>
<a class="sourceLine" id="cb69-12" title="12">    lamda.jack&lt;-<span class="kw">eigen</span>(sigma.jack)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb69-13" title="13">    theta.jack[i]&lt;-<span class="kw">max</span>(lamda.jack)<span class="op">/</span><span class="kw">sum</span>(lamda.jack)</a>
<a class="sourceLine" id="cb69-14" title="14">bias&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>theta)</a>
<a class="sourceLine" id="cb69-15" title="15">se.jack&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span>theta)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb69-16" title="16">}</a>
<a class="sourceLine" id="cb69-17" title="17"><span class="kw">print</span>(<span class="kw">c</span>(bias,se.jack))</a></code></pre></div>
<pre><code>## [1] 0.15111313 0.09026046</code></pre>
</div>
<div id="section-15" class="section level1">
<h1>7.10</h1>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
</div>
<div id="answer-11" class="section level1">
<h1>Answer</h1>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb75-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb75-3" title="3">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb75-4" title="4"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb75-5" title="5"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb75-6" title="6"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb75-7" title="7">    y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb75-8" title="8">    x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb75-9" title="9">    </a>
<a class="sourceLine" id="cb75-10" title="10">    J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb75-11" title="11">    yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb75-12" title="12">    e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb75-13" title="13">    </a>
<a class="sourceLine" id="cb75-14" title="14">    J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb75-15" title="15">    yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb75-16" title="16"><span class="st">             </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb75-17" title="17">    e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb75-18" title="18">    </a>
<a class="sourceLine" id="cb75-19" title="19">    J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb75-20" title="20">    logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb75-21" title="21">    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb75-22" title="22">    e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb75-23" title="23">    </a>
<a class="sourceLine" id="cb75-24" title="24">    J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb75-25" title="25">    yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb75-26" title="26"><span class="st">                </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb75-27" title="27"><span class="st">                </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb75-28" title="28">    e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb75-29" title="29">}</a></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>),<span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co">#the estimates of prediction error</span></a></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">L1&lt;-<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb79-2" title="2">L2&lt;-<span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb79-3" title="3">L3&lt;-<span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb79-4" title="4">L4&lt;-<span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(chemical))</a>
<a class="sourceLine" id="cb79-5" title="5"><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">summary</span>(L1)<span class="op">$</span>adj.r.square,<span class="kw">summary</span>(L2)<span class="op">$</span>adj.r.square,<span class="kw">summary</span>(L3)<span class="op">$</span>adj.r.square,<span class="kw">summary</span>(L4)<span class="op">$</span>adj.r.square),<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.5282 0.5768 0.5281 0.4871</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co">#the adjusted R-square</span></a></code></pre></div>
<p>From the estimates of prediction error we can see that the quadratic module would still be the best fit for the data, and according to maximum adjusted <span class="math inline">\(R{^2}\)</span>, we wil also choose the Module2.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">L2</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = magnetic ~ chemical + I(chemical^2))
## 
## Coefficients:
##   (Intercept)       chemical  I(chemical^2)  
##      24.49262       -1.39334        0.05452</code></pre>
<p>The fitted regression equation for Model 2 is <span class="math inline">\(\hat{Y}=24.49262-1.39334 X+0.05452 X^{2}\)</span></p>
<div id="section-16" class="section level2">
<h2>2019/11/22</h2>
</div>
<div id="section-17" class="section level2">
<h2>8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb84-2" title="2">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb84-3" title="3">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb84-4" title="4">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb84-5" title="5">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb84-6" title="6"><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb84-7" title="7">}</a>
<a class="sourceLine" id="cb84-8" title="8"></a>
<a class="sourceLine" id="cb84-9" title="9">n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb84-10" title="10">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb84-11" title="11">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb84-12" title="12">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb84-13" title="13"></a>
<a class="sourceLine" id="cb84-14" title="14"><span class="co">#The Count 5 test for equal variance</span></a>
<a class="sourceLine" id="cb84-15" title="15">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb84-16" title="16">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb84-17" title="17">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb84-18" title="18">x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></a>
<a class="sourceLine" id="cb84-19" title="19">y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb84-20" title="20"><span class="kw">maxout</span>(x, y)</a>
<a class="sourceLine" id="cb84-21" title="21">}))</a>
<a class="sourceLine" id="cb84-22" title="22"></a>
<a class="sourceLine" id="cb84-23" title="23"><span class="co">#permutation test for equal variance</span></a>
<a class="sourceLine" id="cb84-24" title="24">R &lt;-<span class="st"> </span><span class="dv">999</span></a>
<a class="sourceLine" id="cb84-25" title="25">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb84-26" title="26">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb84-27" title="27">x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean</span></a>
<a class="sourceLine" id="cb84-28" title="28">y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb84-29" title="29">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</a>
<a class="sourceLine" id="cb84-30" title="30">n&lt;-<span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb84-31" title="31">K &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n</a>
<a class="sourceLine" id="cb84-32" title="32">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb84-33" title="33">t0 &lt;-<span class="st"> </span>alphahat</a>
<a class="sourceLine" id="cb84-34" title="34"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb84-35" title="35">k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb84-36" title="36">x1 &lt;-<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb84-37" title="37">y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#complement of x1</span></a>
<a class="sourceLine" id="cb84-38" title="38">reps[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">maxout</span>(x,y))</a>
<a class="sourceLine" id="cb84-39" title="39">}</a>
<a class="sourceLine" id="cb84-40" title="40">p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0, reps)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0))</a>
<a class="sourceLine" id="cb84-41" title="41"><span class="kw">round</span>(<span class="kw">c</span>(t0,p),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [1] 0.057 0.001</code></pre>
</div>
<div id="question2" class="section level2">
<h2>Question2</h2>
<p>Power comparison (distance correlation test versus ball covariance test) Model 1: Y = X/4 + e Model 2: Y = X/4 × e X ∼ N(02, I2), e ∼ N 02, I2), X and e are independent</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb86-2" title="2">x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x)</a>
<a class="sourceLine" id="cb86-3" title="3">y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb86-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</a>
<a class="sourceLine" id="cb86-5" title="5">m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb86-6" title="6"><span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb86-7" title="7"><span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb86-8" title="8"><span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb86-9" title="9">Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb86-10" title="10">d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb86-11" title="11">m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d)</a>
<a class="sourceLine" id="cb86-12" title="12">M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb86-13" title="13">a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m)</a>
<a class="sourceLine" id="cb86-14" title="14">b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb86-15" title="15"><span class="kw">return</span>(b <span class="op">+</span><span class="st"> </span>M)</a>
<a class="sourceLine" id="cb86-16" title="16">}</a>
<a class="sourceLine" id="cb86-17" title="17">A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x)</a>
<a class="sourceLine" id="cb86-18" title="18">B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb86-19" title="19">dCov &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb86-20" title="20">}</a></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb87-2" title="2">  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb87-3" title="3">  q1 &lt;-<span class="st"> </span>dims[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb87-4" title="4">  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb87-5" title="5">  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] </a>
<a class="sourceLine" id="cb87-6" title="6">  y &lt;-<span class="st"> </span>z[ix, q1<span class="op">:</span>d]</a>
<a class="sourceLine" id="cb87-7" title="7">  <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb87-8" title="8">}</a>
<a class="sourceLine" id="cb87-9" title="9"></a>
<a class="sourceLine" id="cb87-10" title="10"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">sigma&lt;-<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb90-2" title="2">x&lt;-<span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="dv">100</span>,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb90-3" title="3">e&lt;-<span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="dv">100</span>,<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),sigma)</a>
<a class="sourceLine" id="cb90-4" title="4">y1&lt;-x<span class="op">/</span><span class="dv">4</span><span class="op">+</span>e</a>
<a class="sourceLine" id="cb90-5" title="5">y2&lt;-x<span class="op">/</span><span class="dv">4</span><span class="op">*</span>e</a>
<a class="sourceLine" id="cb90-6" title="6"></a>
<a class="sourceLine" id="cb90-7" title="7"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb90-8" title="8"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb90-9" title="9">z1&lt;-<span class="kw">matrix</span>(<span class="kw">rbind</span>(x,y1),<span class="dv">100</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb90-10" title="10">z2&lt;-<span class="kw">matrix</span>(<span class="kw">rbind</span>(x,y2),<span class="dv">100</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb90-11" title="11">boot.obj1 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z1, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb90-12" title="12"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb90-13" title="13">boot.obj2 &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z2, <span class="dt">statistic =</span> ndCov2, <span class="dt">R =</span> <span class="dv">999</span>,</a>
<a class="sourceLine" id="cb90-14" title="14"><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">dims =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb90-15" title="15">tb1 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb90-16" title="16">tb2 &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb90-17" title="17"></a>
<a class="sourceLine" id="cb90-18" title="18">m&lt;-<span class="fl">1e2</span></a>
<a class="sourceLine" id="cb90-19" title="19">p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb90-20" title="20"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb90-21" title="21">p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb1 <span class="op">&gt;=</span><span class="st"> </span>boot.obj1<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb90-22" title="22">p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(tb2 <span class="op">&gt;=</span><span class="st"> </span>boot.obj2<span class="op">$</span>t0)</a>
<a class="sourceLine" id="cb90-23" title="23">p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y1,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">54321</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb90-24" title="24">p.values[i,<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">bcov.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y2,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">54321</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb90-25" title="25">}</a>
<a class="sourceLine" id="cb90-26" title="26">alpha &lt;-<span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb90-27" title="27">pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb90-28" title="28">pow</a></code></pre></div>
<pre><code>## [1] 1.00 1.00 0.88 1.00</code></pre>
</div>
<div id="section-18" class="section level2">
<h2>2019/11/29</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb92-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb92-3" title="3">  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb92-4" title="4">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb92-5" title="5">  k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb92-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb92-7" title="7">    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb92-8" title="8">        <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(y)) <span class="op">/</span><span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x[i<span class="dv">-1</span>])))))</a>
<a class="sourceLine" id="cb92-9" title="9">          x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb92-10" title="10">            x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb92-11" title="11">            k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb92-12" title="12">          } </a>
<a class="sourceLine" id="cb92-13" title="13">    }</a>
<a class="sourceLine" id="cb92-14" title="14">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb92-15" title="15">}</a>
<a class="sourceLine" id="cb92-16" title="16">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb92-17" title="17">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb92-18" title="18">x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb92-19" title="19">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb92-20" title="20">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb92-21" title="21">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb92-22" title="22">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb92-23" title="23"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb92-24" title="24"><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</a></code></pre></div>
<pre><code>## [1]   40  373  958 1776</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1"><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k<span class="op">/</span>N,rw2<span class="op">$</span>k<span class="op">/</span>N,rw3<span class="op">$</span>k<span class="op">/</span>N,rw4<span class="op">$</span>k<span class="op">/</span>N))</a></code></pre></div>
<pre><code>## [1] 0.0200 0.1865 0.4790 0.8880</code></pre>
<p>From the result we can see that both the second chain and the third chain has a rejection rate in the range [0.15,0.5].</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="co">#par(mfrow=c(2,2))</span></a>
<a class="sourceLine" id="cb96-2" title="2">index&lt;-<span class="dv">1</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb96-3" title="3">y1&lt;-rw1<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb96-4" title="4">y2&lt;-rw2<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb96-5" title="5">y3&lt;-rw3<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb96-6" title="6">y4&lt;-rw4<span class="op">$</span>x[index]</a>
<a class="sourceLine" id="cb96-7" title="7"><span class="kw">plot</span>(index,y1,<span class="dt">main=</span><span class="st">&quot;sigma=0.05&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">plot</span>(index,y2,<span class="dt">main=</span><span class="st">&quot;sigma=0.5&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">plot</span>(index,y3,<span class="dt">main=</span><span class="st">&quot;sigma=2&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">plot</span>(index,y4,<span class="dt">main=</span><span class="st">&quot;sigma=16&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;X&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6kNtmAABmADpmZjpmZmZmZrZmtrZmtv+QOgCQOjqQkGaQ2/+2ZgC2Zma2/7a2/9u2///bkDrb/9vb////tmb/25D//7b//9v///+IfQCkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAI6klEQVR4nO2di3ajNhRFlYzTh92X04a2ccdJ9P8fWT2QECA4gAUIOHutmbGxdIW29cCZayIk6UWsfQK5Q0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQHWF/T1Kr59n1q5cHXvQojn92QnVbFtQYUo66oHiqe3hOdVsr6g6Xy8iFKQGj9X/fSUvpHVBN1E2Ts3ggo9Ago1Tz4v4qRnzFWXsYPCqNAPzYNysJgIru70WQpYS5DtnV42rCD1t+72T1ZQgF5Y7l5KXdDzv1auVupnW2JWEqS7ZDp+LgWphycziqygs/RjyJQ4mcFzrgs6udHnjs6xSq8kSHXJ9cZ2sjDPlRsjSB2wfxsrBj3kWktMIOhsdSdnJUF2RpkOmU5WC5Fdg9wYs4LK0n2C/FxNzVprkFtorrZfVkeHIOPnag6EU0yGgvQ/xRxzbMVtvtzH8Aiyw6hHkJ2O+xL09afuoe5SbA2qCzJXOe1FWnpB6h9de5bNfr1F2u7tbvDUd7HWCDLFOtcgW7ta0FOy8nWQGgix66DIGtS3SLuPGnNcCK22BpnJoidGcCX9/N69iz293dpLTLVxRa8CUpDZZ7EZPzNMJBdBhbkomufz5kPkIuhe250yIhdB5ZVjbhMsI0G5QkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMAYQZ8XnT0xW8p2nowWdLMZS9fZzigzxgoq1dzy+y/QmRgr6OPFCLofZpIlHkFiM8wjSEc+SbdcPxhuVWYRJI2jpze1kXUlAx5e0MLh5mNhQY2pPXyGr8ZMgnSqpF2kO3YxMSXqGswj6KbWn8+LXqUpKMbXq/3yidriKSiG+4BRfPtOQTHsCFIUJwqK4rSY75z0hTuqILWL2Un29UpBD7VLQSAcBYFwFATCURAIR0EgHAWBcBQEwlEQCEdBzSiNn4VTEAhHQSAcBYFwFATCURAIR0EgHAWBcAcVNCCBioJAAhUFofSX8VHXYTZBIIGKgjiCehieQHVQQXJwAtVxBQ0MR0HNKPx50LhwFATCHVRQeCdsXgfF6EzqaIY7qiBlCNzm8OiC1BVQ/9d8Di9oYDgKAuEoCISjIBCOgkA4CgLhKAiE27Wgvx/5NupeBX3+7p5/vDz0dd3dCrqUdwKf+Ls79v/zIP8LmB68pfxuBelPWU+/Pn5H+R0LKgdRmnb3KOimR9DD91PYrSD/21Ae/O04exX06C7WbHdY82tq3MR10IYEhSx3Jb1RQSnapSAQjoJAOAoC4Q4qKHUS50KCos3MJyhhEmer1DzGlhWUMgVvl4LiSZzTfh6EBCXylekIGhB4h4JGJHEeUZAck8Q5XJDoOiDSKFpU0MBwcwoS9TqtcJHjkVcoKDyeqSAYeoCgrq6NECSiYXIWJNqF2wfsn4MKEvUHiQR13d1yV4KqAzFBwr/i2xGtypHmRMTR9gTpJ9UBMUCQ7nbbrm++Oh67QXLGgsz7WT4K6gwVJAJBYsOC3LlHZj8SJIYLiszP8lUfyQmSmQuqvaOBCTlMUCmjW5BwVcoIEUG1QZSFoPKMGwM8Jqg85DvUFuQnVFOQDwIF1TqbgSAh/Epaa6guSLhuVv9UgoScIqh6Q8pxI9xYy1tQHX9IhoJcSdc1Py+Cp6LWQCi2asWrqR40xvLCguod9+cvRDgKgqIyJsifuxtEfl54N8KNGOFmpBfrBMmq2Yig8f2edwSF0lyJ4IVwjWgK8nKDsVE1Ub0VPkygMKwaDLssp1hjp5burbYvBW96bfzVeyl6BYVhvSC/F+YqKJxHrSJ1QeGC64O45/XNqGqifdp+BfcjKmdBstG7riKVoLDoJEG1N0fGBUXPYnCPktAW1FukuTz5EjVBjTUo2mEZFxRskV1nAVheUFC4W5DsERSU7IjqBfkz2aig5vN+QXKYIDclZSCofSqbFxRc2zTKVz3vjFsvslNB9kFEUKxmJM4agoZnd8j1BXU+HRJhSkE5JrtDphEkNyho2P/Ny+MKGnaLLjlJUOT49gQNHkHNBWRE212CcM3y1Yag8RGmFJRjf8dhEkGTSqwmSHZmdzR+YPFg21sWlDTc9LbzFuR/i1aacFOgIAAFAR5vhoJSRdimoMfZxC62JhQEoCDAaoI2w0qCxgUdWG6VYhOLpw1KQWnKUVCOxSYWTxuUgtKUo6Aci00snjYoBaUptz9Be4KCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB0gu6i77bUldZar5cf4U+Pn58Tx2yRXJBd52B1n12Hz+8NcqBCj18XkwqacqQbVILspkNReetu116rC+HKnRzLxPaE4aMkFqQTRO+dabi306NcqhCJ3dxtmrShYyRXJAZ711p1Op9/VmtF+egHKrQh62VNGSL1ILs1O9cAD4vOsG6OFflQIX+xrSDtCFbLCyoLPT8nk5Q2pAtlp5ittDLNeEUSxqyxdKLtC30w1uSFTUUlChki4W3eXvuqmNJ9mQjKG3IFktfKJrTVitqkqu6chdLGbJF+o8at/7L/ELtyddaOVChh3KKpQzZgh9WARQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCBAdoLa99FNlYYwjewEtaEgAAXV0FPs8/LHxWa06DyWv7Sgm81k1WljnTeSnYVMBSknN/WnUD7uonzy8XI2yWNddyKeh0wFnW1apsmuK57eypvFa13P//yy6IzLVNDVPLAZZD6x1/gqRJrcw6FkLejmBZV3ZrvqbyB03E5/JrIW1BhBmq/X39Kk9w4la0FlwrNeg9ywuX37r+dOqTOQtSCzefldzK7W11Qp9APJW1D9OkiJKdQW//W65DKdnaDcoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCAP8Df554hfJ0pbkAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="section-19" class="section level2">
<h2>2019/12/06</h2>
</div>
<div id="section-20" class="section level2">
<h2>11.1</h2>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp x) = exp(log x) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">x&lt;-<span class="kw">runif</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb100-2" title="2">A&lt;-<span class="kw">log</span>(<span class="kw">exp</span>(<span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb100-3" title="3">B&lt;-<span class="kw">exp</span>(<span class="kw">log</span>(<span class="kw">abs</span>(x)))</a>
<a class="sourceLine" id="cb100-4" title="4">A</a></code></pre></div>
<pre><code>##  [1] 0.14255592 0.87881147 0.65131549 0.64121936 0.53396491 0.79610121
##  [7] 0.03508336 0.51213755 0.73549429 0.61680371</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">B</a></code></pre></div>
<pre><code>##  [1] 0.14255592 0.87881147 0.65131549 0.64121936 0.53396491 0.79610121
##  [7] 0.03508336 0.51213755 0.73549429 0.61680371</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">A<span class="op">==</span>B</a></code></pre></div>
<pre><code>##  [1] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(A,B))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>From the result we can see that this property hold with near equality, but doesn’t hold exactly in computer arithmetic.</p>
</div>
<div id="section-21" class="section level2">
<h2>11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u\]</span> for a, where <span class="math display">\[c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb108-2" title="2">F&lt;-<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb108-3" title="3">  M&lt;-<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb108-4" title="4">  N&lt;-<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb108-5" title="5">  ck1&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb108-6" title="6">  ck2&lt;-<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb108-7" title="7">  I1&lt;-<span class="cf">function</span>(u,k){</a>
<a class="sourceLine" id="cb108-8" title="8">    (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb108-9" title="9">  }</a>
<a class="sourceLine" id="cb108-10" title="10">  I2&lt;-<span class="cf">function</span>(u,k){</a>
<a class="sourceLine" id="cb108-11" title="11">    (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb108-12" title="12">  }</a>
<a class="sourceLine" id="cb108-13" title="13">  L&lt;-<span class="kw">integrate</span>(I1,<span class="dt">lower=</span><span class="fl">0.01</span>,<span class="dt">upper=</span>ck1<span class="fl">-0.001</span>,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">k=</span>k)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb108-14" title="14">  R&lt;-<span class="kw">integrate</span>(I2,<span class="dt">lower=</span><span class="fl">0.01</span>,<span class="dt">upper=</span>ck1<span class="fl">-0.001</span>,<span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,<span class="dt">k=</span>k)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb108-15" title="15">  AK&lt;-M<span class="op">*</span>L<span class="op">-</span>N<span class="op">*</span>R</a>
<a class="sourceLine" id="cb108-16" title="16">}</a>
<a class="sourceLine" id="cb108-17" title="17">solution&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb108-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)) {</a>
<a class="sourceLine" id="cb108-19" title="19">  f&lt;-<span class="cf">function</span>(a) <span class="kw">F</span>(a,k[i])</a>
<a class="sourceLine" id="cb108-20" title="20">  solution[i]&lt;-<span class="kw">uniroot</span>(f,<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.9</span>))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb108-21" title="21">}</a>
<a class="sourceLine" id="cb108-22" title="22">solution</a></code></pre></div>
<pre><code>##  [1] 0.01269123 0.01229640 0.01204869 0.01188042 0.01175868 0.01166653
##  [7] 0.01159434 0.01153625 0.01148851 0.01144857 0.01141466 0.01138552
## [13] 0.01136020 0.01133800 0.01131837 0.01130090 0.01128524 0.01127113
## [19] 0.01125835 0.01124671 0.01123608 0.01122633 0.01105497 0.01101058
## [25] 0.01100507</code></pre>
</div>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
<p>Let the three alleles be A, B, and O with allele frequencies p, q, and r. The 6 genotype frequencies under HWE and complete counts are as follows. <span class="math display">\[\begin{array}{|c|c|c|c|c|c|c|}\hline \text { Genotype } &amp; {A A} &amp; {B B} &amp; {O O} &amp; {A O} &amp; {B O} &amp; {A B} &amp; {S u m} \\ \hline \text { Frequency } &amp; {p^{\sim 2}} &amp; {q^{\wedge 2}} &amp; {r^{\sim 2}} &amp; {2 p r} &amp; {2 q r} &amp; {2 p q} &amp; {1} \\ \hline \text { Count } &amp; {n A A} &amp; {n B B} &amp; {n O O} &amp; {n A O} &amp; {n B O} &amp; {n A B} &amp; {n} \\ \hline\end{array}\]</span> Observed data: nA· = nAA + nAO = 28 (A-type), nB· = nBB + nBO = 24 (B-type), nOO = 41 (O-type), nAB = 70 (AB-type).</p>
<p>Use EM algorithm to solve MLE of p and q (consider missing data nAA and nBB).</p>
<p>Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">blood&lt;-<span class="cf">function</span>(p,n.obs){</a>
<a class="sourceLine" id="cb110-2" title="2">  n&lt;-<span class="kw">sum</span>(n.obs)</a>
<a class="sourceLine" id="cb110-3" title="3">  na&lt;-n.obs[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb110-4" title="4">  nb&lt;-n.obs[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb110-5" title="5">  noo&lt;-n.obs[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb110-6" title="6">  nab&lt;-n.obs[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb110-7" title="7">  </a>
<a class="sourceLine" id="cb110-8" title="8">  pa&lt;-pb&lt;-po&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb110-9" title="9">  pa[<span class="dv">1</span>]&lt;-p[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb110-10" title="10">  pb[<span class="dv">1</span>]&lt;-p[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb110-11" title="11">  po[<span class="dv">1</span>]&lt;-<span class="dv">1</span><span class="op">-</span>p[<span class="dv">1</span>]<span class="op">-</span>p[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb110-12" title="12">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">20</span>){</a>
<a class="sourceLine" id="cb110-13" title="13">    pa.old&lt;-pa[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb110-14" title="14">    pb.old&lt;-pb[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb110-15" title="15">    po.old&lt;-po[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb110-16" title="16">    </a>
<a class="sourceLine" id="cb110-17" title="17">    temp1&lt;-pa.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pa.old<span class="op">*</span>po.old</a>
<a class="sourceLine" id="cb110-18" title="18">    naa&lt;-na<span class="op">*</span>pa.old<span class="op">^</span><span class="dv">2</span><span class="op">/</span>temp1</a>
<a class="sourceLine" id="cb110-19" title="19">    nao&lt;-<span class="dv">2</span><span class="op">*</span>na<span class="op">*</span>pa.old<span class="op">*</span>po.old<span class="op">/</span>temp1</a>
<a class="sourceLine" id="cb110-20" title="20">    temp2&lt;-pb.old<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>pb.old<span class="op">*</span>po.old</a>
<a class="sourceLine" id="cb110-21" title="21">    nbb&lt;-nb<span class="op">*</span>pb.old<span class="op">^</span><span class="dv">2</span><span class="op">/</span>temp2</a>
<a class="sourceLine" id="cb110-22" title="22">    nbo&lt;-<span class="dv">2</span><span class="op">*</span>nb<span class="op">*</span>pb.old<span class="op">*</span>po.old<span class="op">/</span>temp2</a>
<a class="sourceLine" id="cb110-23" title="23">    pa[i]&lt;-(<span class="dv">2</span><span class="op">*</span>naa<span class="op">+</span>nao<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb110-24" title="24">    pb[i]&lt;-(<span class="dv">2</span><span class="op">*</span>nbb<span class="op">+</span>nbo<span class="op">+</span>nab)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb110-25" title="25">    po[i]&lt;-(<span class="dv">2</span><span class="op">*</span>noo<span class="op">+</span>nao<span class="op">+</span>nbo)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>n)</a>
<a class="sourceLine" id="cb110-26" title="26">  }</a>
<a class="sourceLine" id="cb110-27" title="27">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">pa=</span>pa,<span class="dt">pb=</span>pb,<span class="dt">po=</span>po))</a>
<a class="sourceLine" id="cb110-28" title="28">}</a>
<a class="sourceLine" id="cb110-29" title="29"></a>
<a class="sourceLine" id="cb110-30" title="30">n.obs&lt;-<span class="kw">c</span>(<span class="dv">28</span>,<span class="dv">24</span>,<span class="dv">41</span>,<span class="dv">70</span>)</a>
<a class="sourceLine" id="cb110-31" title="31">p&lt;-<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb110-32" title="32">a&lt;-<span class="kw">blood</span>(p,n.obs)</a>
<a class="sourceLine" id="cb110-33" title="33">p&lt;-a<span class="op">$</span>pa</a>
<a class="sourceLine" id="cb110-34" title="34">q&lt;-a<span class="op">$</span>pb</a>
<a class="sourceLine" id="cb110-35" title="35">r&lt;-a<span class="op">$</span>po</a>
<a class="sourceLine" id="cb110-36" title="36"><span class="kw">print</span>(<span class="kw">cbind</span>(p,q,r))</a></code></pre></div>
<pre><code>##               p         q         r
##  [1,] 0.3333333 0.3333333 0.3333333
##  [2,] 0.3292434 0.3128834 0.3578732
##  [3,] 0.3276746 0.3107368 0.3615886
##  [4,] 0.3273954 0.3104695 0.3621351
##  [5,] 0.3273519 0.3104328 0.3622153
##  [6,] 0.3273454 0.3104276 0.3622270
##  [7,] 0.3273444 0.3104268 0.3622288
##  [8,] 0.3273443 0.3104267 0.3622290
##  [9,] 0.3273442 0.3104267 0.3622291
## [10,] 0.3273442 0.3104267 0.3622291
## [11,] 0.3273442 0.3104267 0.3622291
## [12,] 0.3273442 0.3104267 0.3622291
## [13,] 0.3273442 0.3104267 0.3622291
## [14,] 0.3273442 0.3104267 0.3622291
## [15,] 0.3273442 0.3104267 0.3622291
## [16,] 0.3273442 0.3104267 0.3622291
## [17,] 0.3273442 0.3104267 0.3622291
## [18,] 0.3273442 0.3104267 0.3622291
## [19,] 0.3273442 0.3104267 0.3622291
## [20,] 0.3273442 0.3104267 0.3622291</code></pre>
<p>From the result we can see that after about 4 iterations, p and q converge to 0.32735 and 0.31043, respectively.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>),p,<span class="dt">xlab =</span> <span class="st">&quot;iteration&quot;</span>,<span class="dt">ylab=</span><span class="st">&#39;p&#39;</span>,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">main=</span><span class="st">&quot;The interation plot of probability of &#39;p&#39;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>),q,<span class="dt">xlab =</span> <span class="st">&quot;iteration&quot;</span>,<span class="dt">ylab=</span><span class="st">&#39;q&#39;</span>,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">main=</span><span class="st">&quot;The interation plot of probability of &#39;q&#39;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-22" class="section level2">
<h2>2019/12/13</h2>
</div>
<div id="section-23" class="section level2">
<h2>3</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list(</p>
<p>mpg ~ disp,</p>
<p>mpg ~ I(1 / disp),</p>
<p>mpg ~ disp + wt,</p>
<p>mpg ~ I(1 / disp) + wt</p>
<p>)</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb114-2" title="2">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb114-3" title="3">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb114-4" title="4">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb114-5" title="5">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb114-6" title="6">)</a>
<a class="sourceLine" id="cb114-7" title="7">la&lt;-<span class="kw">lapply</span>(formulas,lm,<span class="dt">data =</span> mtcars) <span class="co">#use lapply()</span></a>
<a class="sourceLine" id="cb114-8" title="8">la</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">out&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(formulas))</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</a>
<a class="sourceLine" id="cb116-3" title="3">  out[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb116-4" title="4">}</a>
<a class="sourceLine" id="cb116-5" title="5">out <span class="co">#use loop</span></a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="section-24" class="section level2">
<h2>4</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) {</p>
<p>rows &lt;- sample(1:nrow(mtcars), rep = TRUE)</p>
<p>mtcars[rows, ]</p>
<p>})</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb118-2" title="2">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb118-3" title="3">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb118-4" title="4">})</a>
<a class="sourceLine" id="cb118-5" title="5"><span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp) <span class="co">#use lapply()</span></a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.52134     -0.03256  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.40837     -0.04075  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.62515     -0.04146  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.7317      -0.0398  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.73260     -0.03418  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.17415     -0.03681  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.28965     -0.04491  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.71212     -0.04404  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.24010     -0.04399  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.15996     -0.03579</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">out&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(bootstraps))</a>
<a class="sourceLine" id="cb120-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)) {</a>
<a class="sourceLine" id="cb120-3" title="3">  out[[i]]&lt;-<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])</a>
<a class="sourceLine" id="cb120-4" title="4">}</a>
<a class="sourceLine" id="cb120-5" title="5">out <span class="co">#use loop</span></a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.52134     -0.03256  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.40837     -0.04075  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.62515     -0.04146  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.7317      -0.0398  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.73260     -0.03418  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.17415     -0.03681  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.28965     -0.04491  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.71212     -0.04404  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.24010     -0.04399  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.15996     -0.03579</code></pre>
</div>
<div id="section-25" class="section level2">
<h2>5</h2>
<p>For each model in the previous two exercises, extract <span class="math display">\[R^{2}\]</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="co"># exercise 3&#39;s lapply()</span></a>
<a class="sourceLine" id="cb122-2" title="2">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb122-3" title="3">  mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb122-4" title="4">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb122-5" title="5">  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb122-6" title="6">  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb122-7" title="7">)</a>
<a class="sourceLine" id="cb122-8" title="8">la&lt;-<span class="kw">lapply</span>(formulas,lm,<span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb122-9" title="9">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb122-10" title="10"><span class="kw">sapply</span>(la,rsq)</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="co"># exercise 3&#39;s loop</span></a>
<a class="sourceLine" id="cb124-2" title="2">out&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(formulas))</a>
<a class="sourceLine" id="cb124-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)) {</a>
<a class="sourceLine" id="cb124-4" title="4">  out[[i]]&lt;-<span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb124-5" title="5">}</a>
<a class="sourceLine" id="cb124-6" title="6"><span class="kw">sapply</span>(out, rsq)</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="co"># exercise 4&#39;s lapply()</span></a>
<a class="sourceLine" id="cb126-2" title="2">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb126-3" title="3">  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb126-4" title="4">  mtcars[rows, ]</a>
<a class="sourceLine" id="cb126-5" title="5">})</a>
<a class="sourceLine" id="cb126-6" title="6">a&lt;-<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)</a>
<a class="sourceLine" id="cb126-7" title="7"><span class="kw">sapply</span>(a, rsq)</a></code></pre></div>
<pre><code>##  [1] 0.7899909 0.6486319 0.8183109 0.7316967 0.7888718 0.7944227 0.7461593
##  [8] 0.6862949 0.7626672 0.6117390</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="co"># exercise 4&#39;s loop</span></a>
<a class="sourceLine" id="cb128-2" title="2">out&lt;-<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="kw">length</span>(bootstraps))</a>
<a class="sourceLine" id="cb128-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)) {</a>
<a class="sourceLine" id="cb128-4" title="4">  out[[i]]&lt;-<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])</a>
<a class="sourceLine" id="cb128-5" title="5">}</a>
<a class="sourceLine" id="cb128-6" title="6"><span class="kw">sapply</span>(out, rsq)</a></code></pre></div>
<pre><code>##  [1] 0.7899909 0.6486319 0.8183109 0.7316967 0.7888718 0.7944227 0.7461593
##  [8] 0.6862949 0.7626672 0.6117390</code></pre>
</div>
<div id="section-26" class="section level2">
<h2>3</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<p>trials &lt;- replicate(</p>
<p>100,</p>
<p>t.test(rpois(10, 10), rpois(7, 10)),</p>
<p>simplify = FALSE</p>
<p>)</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb130-2" title="2">  <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb130-3" title="3">  <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb130-4" title="4">  <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb130-5" title="5">)</a>
<a class="sourceLine" id="cb130-6" title="6"><span class="co">#use an anonymous function</span></a>
<a class="sourceLine" id="cb130-7" title="7"><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]]) </a></code></pre></div>
<pre><code>##   [1] 0.280779971 0.705193767 0.870278491 0.943101988 0.510669946 0.193018592
##   [7] 0.488417501 0.222464569 0.074094087 0.702090286 0.594813037 0.528076814
##  [13] 0.794952425 0.159087698 0.956469965 0.575621200 0.042853874 0.556637218
##  [19] 0.167266241 0.312118109 0.845479425 0.348976977 0.629947490 0.770394294
##  [25] 0.294866613 0.912959321 0.280674005 0.244109062 0.314333227 0.622952720
##  [31] 0.221639805 0.544156712 0.822654384 0.588507687 0.133978373 0.276233672
##  [37] 0.967980299 0.661643181 0.924551210 0.452331956 0.212522904 0.085664855
##  [43] 0.272814580 0.343724343 0.290426122 0.005118411 0.942234483 0.947098781
##  [49] 0.316496953 0.551701884 0.592352702 0.588888183 0.983936957 0.441716341
##  [55] 0.535261950 0.357742130 0.387979937 0.560930236 0.883481187 0.426304012
##  [61] 0.050200298 0.528922315 0.067928358 0.953792200 0.481596820 0.945733679
##  [67] 0.110442080 0.802890846 0.834207517 0.687813009 0.541827677 0.325368715
##  [73] 0.707348374 0.739308553 0.147288438 0.258661351 0.039871742 0.261398180
##  [79] 0.384588918 0.650384323 0.833540098 0.145286194 0.100281008 0.570172230
##  [85] 0.482368104 0.414403191 0.062532063 0.422677334 0.691021933 0.792109091
##  [91] 0.463541748 0.728671800 0.468135850 0.740911639 0.458163816 0.011005555
##  [97] 0.755858571 0.600103641 0.847586887 0.312225522</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="co"># use sapply()</span></a>
<a class="sourceLine" id="cb132-2" title="2"><span class="kw">sapply</span>(trials,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;p.value&quot;</span>)</a></code></pre></div>
<pre><code>##   [1] 0.280779971 0.705193767 0.870278491 0.943101988 0.510669946 0.193018592
##   [7] 0.488417501 0.222464569 0.074094087 0.702090286 0.594813037 0.528076814
##  [13] 0.794952425 0.159087698 0.956469965 0.575621200 0.042853874 0.556637218
##  [19] 0.167266241 0.312118109 0.845479425 0.348976977 0.629947490 0.770394294
##  [25] 0.294866613 0.912959321 0.280674005 0.244109062 0.314333227 0.622952720
##  [31] 0.221639805 0.544156712 0.822654384 0.588507687 0.133978373 0.276233672
##  [37] 0.967980299 0.661643181 0.924551210 0.452331956 0.212522904 0.085664855
##  [43] 0.272814580 0.343724343 0.290426122 0.005118411 0.942234483 0.947098781
##  [49] 0.316496953 0.551701884 0.592352702 0.588888183 0.983936957 0.441716341
##  [55] 0.535261950 0.357742130 0.387979937 0.560930236 0.883481187 0.426304012
##  [61] 0.050200298 0.528922315 0.067928358 0.953792200 0.481596820 0.945733679
##  [67] 0.110442080 0.802890846 0.834207517 0.687813009 0.541827677 0.325368715
##  [73] 0.707348374 0.739308553 0.147288438 0.258661351 0.039871742 0.261398180
##  [79] 0.384588918 0.650384323 0.833540098 0.145286194 0.100281008 0.570172230
##  [85] 0.482368104 0.414403191 0.062532063 0.422677334 0.691021933 0.792109091
##  [91] 0.463541748 0.728671800 0.468135850 0.740911639 0.458163816 0.011005555
##  [97] 0.755858571 0.600103641 0.847586887 0.312225522</code></pre>
</div>
<div id="section-27" class="section level2">
<h2>7</h2>
<p>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()? Why or why not?</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="co">#library(parallel)</span></a>
<a class="sourceLine" id="cb134-2" title="2"><span class="co">#boot_df &lt;- function(x) x[sample(nrow(x), rep = T), ]</span></a>
<a class="sourceLine" id="cb134-3" title="3"><span class="co">#rsquared &lt;- function(mod) summary(mod)$r.square</span></a>
<a class="sourceLine" id="cb134-4" title="4"><span class="co">#boot_lm &lt;- function(i) {</span></a>
<a class="sourceLine" id="cb134-5" title="5"><span class="co">#dat &lt;- boot_df(mtcars)</span></a>
<a class="sourceLine" id="cb134-6" title="6"><span class="co">#rsquared(lm(mpg ~ wt + disp, data = dat))</span></a>
<a class="sourceLine" id="cb134-7" title="7"><span class="co">#}</span></a>
<a class="sourceLine" id="cb134-8" title="8"><span class="co">#n &lt;- 1e4</span></a>
<a class="sourceLine" id="cb134-9" title="9"><span class="co">#system.time(mcsapply(1:n, boot_lm, mc.cores = 4))</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
